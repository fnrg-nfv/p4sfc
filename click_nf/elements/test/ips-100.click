define(
	$header		"00 00 00 01 00 05",
	$srcmac		0:0:0:0:0:0,
	$dstmac		0:0:0:0:0:0,
	$debug		false,
	$rate		1,
	$range		0,
	$flowsize	10,
	$length		1500,
);


ips :: SampleIPS(
	$debug,
	DEPTH 128,
	2|00 00 00 06 00 00 00|Drives|24 00|,
	|85 80 00 01 00 01 00 00 00 00|,
	thisissometempspaceforthesockinaddrinyeahyeahiknowthisislamebutanywaywhocareshorizongotitworkingsoalliscool,
	1|C0 B0|?1|DB B3 FF|1|C9 CD 80|1|C0|,
	1|C0 B0 02 CD 80 85 C0|uL|EB|L^|B0|,
	|89 F7 29 C7 89 F3 89 F9 89 F2 AC|<|FE|,
	|EB|n^|C6 06 9A|1|C9 89|N|01 C6|F|05|,
	|90 1A C0 0F 90 02| |08 92 02| |0F D0 23 BF F8|,
	3|C9 B1 10|?|E9 06|Q<|FA|G3|C0|P|F7 D0|P,
	^|0E|1|C0 B0 3B 8D|~|0E 89 FA 89 F9|,
	h]^|FF D5 FF D4 FF F5 8B F5 90|f1,
	|D8|@|CD 80 E8 D9 FF FF FF|/bin/sh,
	V|0E|1|C0 B0 3B 8D|~|12 89 F9 89 F9|,
	|EB 23|^3|C0 88|F|FA 89|F|F5 89|6,
	C|07 89|[|08 8D|K|08 89|C|0C B0 0B CD 80|1|C0 FE C0 CD 80 E8 94 FF FF FF|/bin/sh|0A|,
	|AB CD 09 80 00 00 00 01 00 00 00 00 00 00 01 00 01|    |02|a,
	|EB|K[S2|E4 83 C3 0B|K|88 23 B8|Pw,
	|B4| |B4|!|8B CC 83 E9 04 8B 19|3|C9|f|B9 10|,
	from|3A 90 90 90 90 90 90 90 90 90 90 90|,
	|EB|E|EB| [|FC|3|C9 B1 82 8B F3 80|+,
	3|C9 B1 10|?|E9 06|Q<|FA|G3|C0|P|F7 D0|P,
	|01 03 00 00 00 00 00 01 00 02 02 E8|,
	|80 00 07 00 00 00 00 00 01|?|00 01 02|,
	^|B0 02 89 06 FE C8 89|F|04 B0 06 89|F,
	|EB|@^1|C0|@|89|F|04 89 C3|@|89 06|,
	|10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F|,
	|08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17|,
	|01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F|,
	|AB CD AB CD AB CD AB CD AB CD AB CD AB CD AB CD|,
	|01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10|,
	Data|00 00 00 00 00 00 00 00 00 00 00 00|,
	ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI,
	|AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA|,
	pccsmysqladm/incs/dbconnect.inc,
	|00 00 00 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|N|00|T|00| |00|1|00|3|00|8|00|1,
	|3A 3A 3A 3A 3A 3A 3A 3A 00 3A 3A 3A 3A 3A 3A 3A 3A|,
	|01|rlogind|3A| Permission denied.,
	|80 07 00 00 07 00 00 04 00 00 00 00 00|,
	|03 E0 F8|%|03 E0 F8|%|03 E0 F8|%|03 E0 F8|%,
	|24 0F 12|4|24 0F 12|4|24 0F 12|4|24 0F 12|4,
	O|FF FB 82|O|FF FB 82|O|FF FB 82|O|FF FB 82|,
	G|FF 04 1F|G|FF 04 1F|G|FF 04 1F|G|FF 04 1F|,
	|08|!|02 80 08|!|02 80 08|!|02 80 08|!|02 80|,
	|0B|9|02 80 0B|9|02 80 0B|9|02 80 0B|9|02 80|,
	|13 C0 1C A6 13 C0 1C A6 13 C0 1C A6 13 C0 1C A6|,
	|80 1C|@|11 80 1C|@|11 80 1C|@|11 80 1C|@|11|,
	|A6 1C C0 13 A6 1C C0 13 A6 1C C0 13 A6 1C C0 13|,
	|90 90 90 90 90 90 90 90 90 90 90 90 90 90|,
	|90 90 90 E8 C0 FF FF FF|/bin/sh,
	MAIL FROM|3A| |7C|/usr/ucb/tail,
	s|00|p|00|_|00|s|00|t|00|a|00|r|00|t|00|_|00|j|00|o|00|b|00|,
	s|00|p|00|_|00|s|00|t|00|a|00|r|00|t|00|_|00|j|00|o|00|b|00|,
	s|00|p|00|_|00|p|00|a|00|s|00|s|00|w|00|o|00|r|00|d|00|,
	s|00|p|00|_|00|d|00|e|00|l|00|e|00|t|00|e|00|_|00|a|00|l|00|e|00|,
	s|00|p|00|_|00|a|00|d|00|d|00|u|00|s|00|e|00|r|00|,
	x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|,
	s|00|p|00|_|00|p|00|a|00|s|00|s|00|w|00|o|00|r|00|d|00|,
	s|00|p|00|_|00|d|00|e|00|l|00|e|00|t|00|e|00|_|00|a|00|l|00|e|00|r|00|t|00|,
	s|00|p|00|_|00|a|00|d|00|d|00|u|00|s|00|e|00|r|00|,
	x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|,
	9 |D0 00 92 01 C2 00|R|00|U|00|9 |EC 00|,
	9 |D0 00 92 01 C2 00|R|00|U|00|9 |EC 00|,
	H|00|%|00|x|00|w|00 90 00 90 00 90 00 90 00 90 00|3|00 C0 00|P|00|h|00|.|00|,
	H|00|%|00|x|00|w|00 90 00 90 00 90 00 90 00 90 00|3|00 C0 00|P|00|h|00|.|00|,
	x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|,
	x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|,
	|FF F3 FF F3 FF F3 FF F3 FF F3|,
	/cfdocs/exampleapp/email/application.cfm,
	/cfdocs/exampleapp/publish/admin/application.cfm,
	/cfdocs/exampleapp/email/getfile.cfm,
	CF_SETDATASOURCEUSERNAME|28 29|,
	/cfdocs/snippets/fileexists.cfm,
	/cfdocs/examples/parks/detail.cfm,
	/cfdocs/examples/cvbeans/beaninfo.cfm,
	CFUSION_DBCONNECTIONS_FLUSH|28 29|,
	CF_SETDATASOURCEPASSWORD|28 29|,
	CF_ISCOLDFUSIONDATASOURCE|28 29|,
	/cfdocs/expeval/displayopenedfile.cfm,
	/cfdocs/examples/mainframeset.cfm,
	CFUSION_SETTINGS_REFRESH|28 29|,
	/cfide/administrator/startstop.html,
	/cfdocs/snippets/gettempdirectory.cfm,
	/scripts/iisadmin/ism.dll?http/dir,
	/iissamples/exair/howitworks/codebrws.asp,
	/iissamples/sdk/asp/docs/codebrws.asp,
	/advworks/equipment/catalog_type.asp,
	/SiteServer/Publishing/viewcode.asp,
	/Sites/Knowledge/Membership/Inspired/ViewCode.asp,
	/Sites/Knowledge/Membership/Inspiredtutorial/ViewCode.asp,
	/Sites/Samples/Knowledge/Membership/Inspiredtutorial/ViewCode.asp,
	/Sites/Samples/Knowledge/Push/ViewCode.asp,
	/Sites/Samples/Knowledge/Search/ViewCode.asp,
	/scripts/samples/search/webhits.exe,
	/servlet/com.unify.servletexec.UploadServlet,
	ref%3Cscript%20language%3D%22Javascript,
	|BA|I|FE FF FF F7 D2 B9 BF FF FF FF F7 D1|,
	User-Agent|3A| Java1.2.1|0D 0A|,
	User-Agent|3A| Webtrends Security Analyzer|0D 0A|,
	/contextAdmin/contextAdmin.html
);

ec :: P4SFCEncap();
src::P4SFCSimuFlow(
SRCETH $srcmac,
DSTETH $dstmac,
STOP false, DEBUG $debug, 
LIMIT -1, RATE $rate, BURST 32,
SRCIP 10.0.0.1, DSTIP 77.77.77.77, RANGE $range, LENGTH $length,
FLOWSIZE $flowsize,
SFCH \<$header>,
SEED 1, MAJORFLOW 0.2, MAJORDATA 0.8) 

src	-> Strip(14)
	-> ec
    -> CheckIPHeader
	-> Print(Before-IPS, ACTIVE $debug, MAXLENGTH 200)
    -> ips;

ips[0]  -> Print(Alert, ACTIVE $debug)
        -> [1]ec;
ips[1]  -> [1]ec;

ec[1] -> EtherEncap(0x1234, 0:0:0:0:0:0, 0:0:0:0:0:0)
    	-> pt::PrintTime(DEBUG $debug, OFFSET 4)
		-> tx :: ToDPDKDevice(0)


rx::FromDPDKDevice(0)
    -> Discard

Script(
    TYPE ACTIVE,
    print "TX: $(tx.count)/$(tx.dropped); RX: $(rx.count) latency: $(pt.avg_latency)",
    wait 1,
    loop
);

